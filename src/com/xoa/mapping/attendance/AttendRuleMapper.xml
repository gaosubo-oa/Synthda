<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xoa.dao.attendance.AttendRuleMapper" >
  <resultMap id="BaseResultMap" type="com.xoa.model.attendance.AttendRule" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="ARID" property="arid" jdbcType="INTEGER" />
    <result column="OVERTIME_HOUR" property="overtimeHour" jdbcType="INTEGER" />
    <result column="OVERTIME_DAY" property="overtimeDay" jdbcType="INTEGER" />
    <result column="LATE_TYPE" property="lateType" jdbcType="INTEGER" />
    <result column="LATE_ONCE" property="lateOnce" jdbcType="INTEGER" />
    <result column="LATE_HOUR" property="lateHour" jdbcType="INTEGER" />
    <result column="ONE_LATE_HOUR" property="oneLateHour" jdbcType="INTEGER" />
    <result column="ONE_EARLY_HOUR" property="oneEarlyHour" jdbcType="INTEGER" />
  </resultMap>
  <resultMap id="ResultMapWithBLOBs" type="com.xoa.model.attendance.AttendRule" extends="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="DEPT_ID" property="deptId" jdbcType="LONGVARCHAR" />
  </resultMap>
    <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    ARID, OVERTIME_HOUR, OVERTIME_DAY, LATE_TYPE, LATE_ONCE, LATE_HOUR, ONE_LATE_HOUR, 
    ONE_EARLY_HOUR
  </sql>
  <sql id="Blob_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    DEPT_ID
  </sql>
  <select id="selectByPrimaryKey" resultMap="ResultMapWithBLOBs" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from attend_rule
    where ARID = #{arid,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from attend_rule
    where ARID = #{arid,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.xoa.model.attendance.AttendRule" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into attend_rule (ARID, OVERTIME_HOUR, OVERTIME_DAY, 
      LATE_TYPE, LATE_ONCE, LATE_HOUR, 
      ONE_LATE_HOUR, ONE_EARLY_HOUR, DEPT_ID
      )
    values (#{arid,jdbcType=INTEGER}, #{overtimeHour,jdbcType=INTEGER}, #{overtimeDay,jdbcType=INTEGER}, 
      #{lateType,jdbcType=INTEGER}, #{lateOnce,jdbcType=INTEGER}, #{lateHour,jdbcType=INTEGER}, 
      #{oneLateHour,jdbcType=INTEGER}, #{oneEarlyHour,jdbcType=INTEGER}, #{deptId,jdbcType=LONGVARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.xoa.model.attendance.AttendRule" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into attend_rule
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="arid != null" >
        ARID,
      </if>
      <if test="overtimeHour != null" >
        OVERTIME_HOUR,
      </if>
      <if test="overtimeDay != null" >
        OVERTIME_DAY,
      </if>
      <if test="lateType != null" >
        LATE_TYPE,
      </if>
      <if test="lateOnce != null" >
        LATE_ONCE,
      </if>
      <if test="lateHour != null" >
        LATE_HOUR,
      </if>
      <if test="oneLateHour != null" >
        ONE_LATE_HOUR,
      </if>
      <if test="oneEarlyHour != null" >
        ONE_EARLY_HOUR,
      </if>
      <if test="deptId != null" >
        DEPT_ID,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="arid != null" >
        #{arid,jdbcType=INTEGER},
      </if>
      <if test="overtimeHour != null" >
        #{overtimeHour,jdbcType=INTEGER},
      </if>
      <if test="overtimeDay != null" >
        #{overtimeDay,jdbcType=INTEGER},
      </if>
      <if test="lateType != null" >
        #{lateType,jdbcType=INTEGER},
      </if>
      <if test="lateOnce != null" >
        #{lateOnce,jdbcType=INTEGER},
      </if>
      <if test="lateHour != null" >
        #{lateHour,jdbcType=INTEGER},
      </if>
      <if test="oneLateHour != null" >
        #{oneLateHour,jdbcType=INTEGER},
      </if>
      <if test="oneEarlyHour != null" >
        #{oneEarlyHour,jdbcType=INTEGER},
      </if>
      <if test="deptId != null" >
        #{deptId,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>

  <update id="updateByPrimaryKeySelective" parameterType="com.xoa.model.attendance.AttendRule" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update attend_rule
    <set >
      <if test="overtimeHour != null" >
        OVERTIME_HOUR = #{overtimeHour,jdbcType=INTEGER},
      </if>
      <if test="overtimeDay != null" >
        OVERTIME_DAY = #{overtimeDay,jdbcType=INTEGER},
      </if>
      <if test="lateType != null" >
        LATE_TYPE = #{lateType,jdbcType=INTEGER},
      </if>
      <if test="lateOnce != null" >
        LATE_ONCE = #{lateOnce,jdbcType=INTEGER},
      </if>
      <if test="lateHour != null" >
        LATE_HOUR = #{lateHour,jdbcType=INTEGER},
      </if>
      <if test="oneLateHour != null" >
        ONE_LATE_HOUR = #{oneLateHour,jdbcType=INTEGER},
      </if>
      <if test="oneEarlyHour != null" >
        ONE_EARLY_HOUR = #{oneEarlyHour,jdbcType=INTEGER},
      </if>
      <if test="deptId != null" >
        DEPT_ID = #{deptId,jdbcType=LONGVARCHAR},
      </if>
    </set>
    where ARID = #{arid,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.xoa.model.attendance.AttendRule" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update attend_rule
    set OVERTIME_HOUR = #{overtimeHour,jdbcType=INTEGER},
      OVERTIME_DAY = #{overtimeDay,jdbcType=INTEGER},
      LATE_TYPE = #{lateType,jdbcType=INTEGER},
      LATE_ONCE = #{lateOnce,jdbcType=INTEGER},
      LATE_HOUR = #{lateHour,jdbcType=INTEGER},
      ONE_LATE_HOUR = #{oneLateHour,jdbcType=INTEGER},
      ONE_EARLY_HOUR = #{oneEarlyHour,jdbcType=INTEGER},
      DEPT_ID = #{deptId,jdbcType=LONGVARCHAR}
    where ARID = #{arid,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.xoa.model.attendance.AttendRule" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update attend_rule
    set OVERTIME_HOUR = #{overtimeHour,jdbcType=INTEGER},
      OVERTIME_DAY = #{overtimeDay,jdbcType=INTEGER},
      LATE_TYPE = #{lateType,jdbcType=INTEGER},
      LATE_ONCE = #{lateOnce,jdbcType=INTEGER},
      LATE_HOUR = #{lateHour,jdbcType=INTEGER},
      ONE_LATE_HOUR = #{oneLateHour,jdbcType=INTEGER},
      ONE_EARLY_HOUR = #{oneEarlyHour,jdbcType=INTEGER}
    where ARID = #{arid,jdbcType=INTEGER}
  </update>

 <!-- /**
  * 获取主页数据
  */
  public List<AttendRule> getAttendRuleList();-->
  <select id="getAttendRuleList" resultMap="ResultMapWithBLOBs">
    SELECT * FROM attend_rule ORDER BY arid
  </select>

  <!--/**
     * 查看数据库中是否已经有此部门的规则
     * @param depts
     * @return
     */
    public List<AttendRule> getAttendRuleListByDept
    (@RequestParam("deptIds") String[] depts,@RequestParam("arid") Integer arid);
-->
  <select id="getAttendRuleListByDept" resultMap="ResultMapWithBLOBs">
    SELECT * FROM attend_rule WHERE DEPT_ID in
    <foreach collection="deptIds" item="deptId" separator="," index="index" open="(" close=")">
      #{deptId}
    </foreach>
    <if test="arid!=null">
      and ARID!=#{arid}
    </if>

  </select>

<!--  /**
  * 根据部门id查找对应的规则，如果没有则查找ALL_DEPT记录，如果还没有返回null
  * @param deptId
  * @return
  */
  public List<AttendRule> getAttendRuleByDept(Integer deptId);-->
  <select id="getAttendRuleByDept" resultMap="ResultMapWithBLOBs" parameterType="Integer">
    select * from attend_rule where (DEPT_ID like concat('%,',#{deptId},',%') or DEPT_ID like concat(#{deptId},',%') ) or DEPT_ID="ALL_DEPT" ORDER BY DEPT_ID
  </select>

</mapper>